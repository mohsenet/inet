
vpn()
{
  echo -n "Select server: "   
  read servernumber
  sudo openconnect s$servernumber.speediran.info:555 -u 3m127532
}

exportdb()
{
  echo -n "Please enter your database name: "
  read dbname
  mysqldump -u root -p $dbname > $dbname.sql
  echo "export db finished."
  zip -r $dbname.zip $dbname.sql
  echo "zip db finished."
}

importdb()
{
  echo -n "Please enter your database name: "
  read dbname
  mysql -u root -p $dbname < $dbname.sql
  echo "Import db finished."
}

djangoproject()
{
  echo -n "Please enter your project name: "
  read project_name
  django-admin startproject $project_name
  cd $project_name
  virtualenv venv
  source venv/bin/activate
  pip install django
  pip install mysqlclient
  pip install gunicorn
  deactivate
  echo "### Your project is ready to use ###"
}

nginxconf()
{
  echo "Your project name"
  read project_name
  echo "Enter IP"
  read ip
  echo "Enter port"
  read port
  cat <<EOT > val_1.txt
    server {
        listen ppp;
        server_name iii;

        location / {
            proxy_set_header Host $http_host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_pass http://unix:/home/mohsen/frr/aaa/myproject.sock;
        }
    }
EOT
  sudo sed s/ppp/$port/g val_1.txt > val_2.txt
  sudo sed s/iii/$ip/g val_2.txt > val_1.txt
  sudo sed s/aaa/$project_name/g val_1.txt > val_2.txt
  
  sudo sed -i '/include \/etc\/nginx\/conf.d\/\*.conf;$/r val_2.txt' /etc/nginx/nginx.conf
}

gunicornservice()
{
  sudo touch /etc/systemd/system/gunicorn.service
  echo "Your project name"
  read project_name
  cat <<EOT > val_1.txt
[Unit]
Description=Gunicorn instance to serve myproject
After=network.target

[Service]
User=mohsen
Group=nginx
WorkingDirectory=/home/mohsen/frr/aaa
Environment="PATH=/home/mohsen/frr/aaa/venv/bin"
ExecStart=/home/mohsen/frr/aaa/venv/bin/gunicorn --workers 3 --bind unix:/home/mohsen/frr/aaa/myproject.sock -m 007 aaa.wsgi

[Install]
WantedBy=multi-user.target
EOT
  sudo sed s/aaa/$project_name/g < val_1.txt > /etc/systemd/system/gunicorn.service
}





